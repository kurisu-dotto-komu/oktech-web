---
import PageLayout from "../../layouts/PageLayout.astro";
import Section from "../../components/Section.astro";
import EventDetails from "../../components/EventDetails.astro";
import { Icon } from "astro-icon/components";
import { events, type Event } from "../../data";
import MemberSummary from "../../components/MemberSummary.astro";
import Container from "../../components/Container.astro";
import EventGallery from "../../components/EventGallery.astro";

export function getStaticPaths() {
  return events.map((event) => ({
    params: { event: event.id },
  }));
}

const { event: eventId } = Astro.params;
const currentIndex = events.findIndex((e) => e.id === eventId);
const event = events[currentIndex];
const prevEvent = currentIndex > 0 ? events[currentIndex - 1] : null;
const nextEvent = currentIndex < events.length - 1 ? events[currentIndex + 1] : null;
---

<PageLayout title={`${event.title} - Events`}>
  <Section>
    <div class="flex justify-between items-center mb-8">
      <div class="flex gap-4">
        {
          prevEvent && (
            <a href={`/events/${prevEvent.id}`} class="btn btn-soft gap-2">
              <Icon name="lucide:chevron-left" size={20} />
              Next Event
            </a>
          )
        }
      </div>
      <div class="flex gap-4">
        {
          nextEvent && (
            <a href={`/events/${nextEvent.id}`} class="btn btn-soft gap-2">
              Previous Event
              <Icon name="lucide:chevron-right" size={20} />
            </a>
          )
        }
      </div>
    </div>
    <EventDetails event={event} />
  </Section>
  <!-- <Section inline title="Speakers" /> -->
  <Container grid class="py-12">
    {event.speakers.map((speaker) => <MemberSummary member={speaker} />)}
  </Container>
  {
    event.gallery && event.gallery.length > 0 && (
      <>
        {/* <Section inline title="Gallery" /> */}
        <Container wide grid>
          <EventGallery event={event} />
        </Container>
      </>
    )
  }
</PageLayout>
